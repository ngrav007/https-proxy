==7775== Memcheck, a memory error detector
==7775== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==7775== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==7775== Command: ./bin/proxy 9055
==7775== 
[0;32m[+][0m [+] HTTP Proxy -----------------------------------
[0;33m[*][0m   Proxy Port = 9055
[0;33m[*][0m   Cache Size = 10
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: min timeout equal to threshold - timeout is NULL[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877690.338472[0m
[0;32m[+] proxy: client 4 age: 0.003793[0m
[0;32m[+] proxy: timeout set to 29.996207[0m
[0;32m[+] proxy: timeout set to 29.996206[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handle] socket 4 matched on CLI_QUERY
[Proxy_handle] client 4 receiving
[1;33m[DEBUG][0m proxy_recv: received request from client
CONNECT httpbin.org:443 HTTP/1.1
Host: httpbin.org:443
User-Agent: curl/7.81.0
Proxy-Connection: Keep-Alive


[1;33m[DEBUG][0m proxy: got header
[parse_request]: The request: 
CONNECT httpbin.org:443 HTTP/1.1
Host: httpbin.org:443
User-Agent: curl/7.81.0
Proxy-Connection: Keep-Alive


[parse_startline]: The request: 
connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[parse_method]: The request: 
connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[parse_method]: method: connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[1;33m[DEBUG][0m query_new: host: httpbin.org
[0;34m[*][0m proxy: got CONNECT request -- sending 200 OK response
[0;34m[*][0m proxy: client is in CONNECT state
[Proxy_Send] sending non-null buffer of size: 19.
[Proxy_send] Bytes sent: 19
Bytes To Write: 0
Bytes Written: 19
[0;32m[END PROXY SEND][0m
client->state = 3
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877690.805438[0m
[0;32m[+] proxy: client 4 age: 0.410034[0m
[0;32m[+] proxy: timeout set to 29.589966[0m
[0;32m[+] proxy: timeout set to 29.589965[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[0;34m[*][0m proxy: client is in SSL state
[!] Domain name httpbin.org already exists in /workspaces/Development/https-proxy/etc/ext/eregion.proxy.ext
[ProxySSL_accept] Checking for a SSL/TLS connection...
[ProxySSL_accept] SSL/TLS connection established!
[ProxySSL_accept] SSL/TLS connection established!
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877691.237151[0m
[0;32m[+] proxy: client 4 age: 0.000603[0m
[0;32m[+] proxy: timeout set to 29.999397[0m
[0;32m[+] proxy: timeout set to 29.999397[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handle] socket 4 matched on CLI_QUERY
[Proxy_handle] ssl client 4 receiving
[ProxySSL_read] CLIENT matched on CLI_GET
buffer_l: 0
buffer_sz: 1024
[1;33m[DEBUG][0m proxy: got header
[parse_request]: The request: 
GET /ip HTTP/1.1
Host: httpbin.org
User-Agent: curl/7.81.0
Accept: */*


[parse_startline]: The request: 
get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[parse_method]: The request: 
get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[parse_method]: method: get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[1;33m[DEBUG][0m query_new: host: httpbin.org
[0;34m[*][0m proxy: got GET request
[Proxy_handleGET] CLIENT matched on CLI_GET
[Proxy_handleGET]: cache miss!
[Proxy_SSLconnect]: initializing SSL context...
[1;33m[DEBUG][0m [Proxy_SSLconnect]: connecting to server...
[1;33m[DEBUG][0m [Proxy_SSLconnect]: connected to server
[Proxy_SSLconnect]: SSL/TLS connection established!
[1;33m[DEBUG][0m [Proxy_SSLconnect]: SSL_write successful
[Proxy_SSLconnect]: sent request to server of 77 bytes
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877691.847872[0m
[0;32m[+] proxy: client 4 age: 0.603691[0m
[0;32m[+] proxy: timeout set to 29.396309[0m
[0;32m[+] proxy: timeout set to 29.396309[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handleGET] QUERY matched on CLI_GET
[0;33m[?] proxy: buffer_l: 0[0m
BUFFER_SZ = 1024 BUFFER_L = 0
BUFFER_SZ = 1024 BUFFER_L = 0
Receiving 1024 bytes
[ProxySSL_read] QUERY matched on QUERY_TYPE
[ProxySSL_read] QUERY SSL_read returned 229
HTTP/1.1 200 OK
Date: Mon, 12 Dec 2022 20:41:31 GMT
Content-Type: application/json
Content-Length: 31
Connection: keep-alive
Server: gunicorn/19.9.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true


Received 202 bytes
[Proxy_handleGET] QUERY state: 3
[Proxy_handleGET] handleQUERY ret: 0
[Proxy_handleGET]: response received...
[0;33m[Proxy_handle]: sending SSL response to client 4[0m
len: 229
HTTP/1.1 200 OK
Date: Mon, 12 Dec 2022 20:41:31 GMT
Content-Type: application/json
Content-Length: 31
Connection: keep-alive
Server: gunicorn/19.9.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true


[ProxySSL_write] Writing to client: 4
[0;31m[!][0m proxy: failed to send response to client
[Event_Handle] ErrorCode = -9
[0;31m[!][0m proxy: failed to establish SSL connection
[Proxy_Send] sending non-null buffer of size: 29.
[Proxy_send] Bytes sent: 29
Bytes To Write: 0
Bytes Written: 29
[0;32m[END PROXY SEND][0m
[0;33m[?] Closing Socket #4[0m
[0;33m[?] Removing Socket #4 from master_set[0m
[0;33m[?] Remove Socket #4 from client_list[0m
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: min timeout equal to threshold - timeout is NULL[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877711.008718[0m
[0;32m[+] proxy: client 4 age: 0.001168[0m
[0;32m[+] proxy: timeout set to 29.998832[0m
[0;32m[+] proxy: timeout set to 29.998831[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handle] socket 4 matched on CLI_QUERY
[Proxy_handle] client 4 receiving
[1;33m[DEBUG][0m proxy_recv: received request from client
CONNECT httpbin.org:443 HTTP/1.1
Host: httpbin.org:443
User-Agent: curl/7.81.0
Proxy-Connection: Keep-Alive


[1;33m[DEBUG][0m proxy: got header
[parse_request]: The request: 
CONNECT httpbin.org:443 HTTP/1.1
Host: httpbin.org:443
User-Agent: curl/7.81.0
Proxy-Connection: Keep-Alive


[parse_startline]: The request: 
connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[parse_method]: The request: 
connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[parse_method]: method: connect httpbin.org:443 http/1.1
host: httpbin.org:443
user-agent: curl/7.81.0
proxy-connection: keep-alive


[1;33m[DEBUG][0m query_new: host: httpbin.org
[0;34m[*][0m proxy: got CONNECT request -- sending 200 OK response
[0;34m[*][0m proxy: client is in CONNECT state
[Proxy_Send] sending non-null buffer of size: 19.
[Proxy_send] Bytes sent: 19
Bytes To Write: 0
Bytes Written: 19
[0;32m[END PROXY SEND][0m
client->state = 3
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877711.077754[0m
[0;32m[+] proxy: client 4 age: 0.009136[0m
[0;32m[+] proxy: timeout set to 29.990864[0m
[0;32m[+] proxy: timeout set to 29.990863[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[0;34m[*][0m proxy: client is in SSL state
[!] Domain name httpbin.org already exists in /workspaces/Development/https-proxy/etc/ext/eregion.proxy.ext
[ProxySSL_accept] Checking for a SSL/TLS connection...
[ProxySSL_accept] SSL/TLS connection established!
[ProxySSL_accept] SSL/TLS connection established!
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877711.213962[0m
[0;32m[+] proxy: client 4 age: 0.000602[0m
[0;32m[+] proxy: timeout set to 29.999398[0m
[0;32m[+] proxy: timeout set to 29.999397[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handle] socket 4 matched on CLI_QUERY
[Proxy_handle] ssl client 4 receiving
[ProxySSL_read] CLIENT matched on CLI_GET
buffer_l: 0
buffer_sz: 1024
[1;33m[DEBUG][0m proxy: got header
[parse_request]: The request: 
GET /ip HTTP/1.1
Host: httpbin.org
User-Agent: curl/7.81.0
Accept: */*


[parse_startline]: The request: 
get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[parse_method]: The request: 
get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[parse_method]: method: get /ip http/1.1
host: httpbin.org
user-agent: curl/7.81.0
accept: */*


[1;33m[DEBUG][0m query_new: host: httpbin.org
[0;34m[*][0m proxy: got GET request
[Proxy_handleGET] CLIENT matched on CLI_GET
[Proxy_handleGET]: cache miss!
[Proxy_SSLconnect]: initializing SSL context...
[1;33m[DEBUG][0m [Proxy_SSLconnect]: connecting to server...
[1;33m[DEBUG][0m [Proxy_SSLconnect]: connected to server
[Proxy_SSLconnect]: SSL/TLS connection established!
[1;33m[DEBUG][0m [Proxy_SSLconnect]: SSL_write successful
[Proxy_SSLconnect]: sent request to server of 77 bytes
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: client 4 now: 1670877711.755095[0m
[0;32m[+] proxy: client 4 age: 0.534379[0m
[0;32m[+] proxy: timeout set to 29.465621[0m
[0;32m[+] proxy: timeout set to 29.465620[0m
[Proxy_run] select returned: 1
[Proxy_run] calling Proxy_handle
[Proxy_handleGET] QUERY matched on CLI_GET
[0;33m[?] proxy: buffer_l: 0[0m
BUFFER_SZ = 1024 BUFFER_L = 0
BUFFER_SZ = 1024 BUFFER_L = 0
Receiving 1024 bytes
[ProxySSL_read] QUERY matched on QUERY_TYPE
[ProxySSL_read] QUERY SSL_read returned 260
HTTP/1.1 200 OK
Date: Mon, 12 Dec 2022 20:41:51 GMT
Content-Type: application/json
Content-Length: 31
Connection: keep-alive
Server: gunicorn/19.9.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true

{
  "origin": "130.64.225.5"
}

Received 202 bytes
[Proxy_handleGET] QUERY state: 3
[Proxy_handleGET] handleQUERY ret: 0
[Proxy_handleGET]: response received...
[0;33m[Proxy_handle]: sending SSL response to client 4[0m
len: 260
HTTP/1.1 200 OK
Date: Mon, 12 Dec 2022 20:41:51 GMT
Content-Type: application/json
Content-Length: 31
Connection: keep-alive
Server: gunicorn/19.9.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true

{
  "origin": "130.64.225.5"
}

[ProxySSL_write] Writing to client: 4
[0;31m[!][0m proxy: failed to send response to client
[Event_Handle] ErrorCode = -9
[0;31m[!][0m proxy: failed to establish SSL connection
[Proxy_Send] sending non-null buffer of size: 29.
[Proxy_send] Bytes sent: 29
Bytes To Write: 0
Bytes Written: 29
[0;32m[END PROXY SEND][0m
[0;33m[?] Closing Socket #4[0m
[0;33m[?] Removing Socket #4 from master_set[0m
[0;33m[?] Remove Socket #4 from client_list[0m
[1;33m[DEBUG][0m proxy: waiting for connections
[0;32m[+] proxy: min timeout equal to threshold - timeout is NULL[0m
